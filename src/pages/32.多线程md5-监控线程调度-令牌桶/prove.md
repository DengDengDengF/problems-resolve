# 一、加速曲线：严格推导

## 1️⃣ 从代码出发（原始定义）

```
now_speed += (MAX_SPEED - now_speed) * accelerate_sensor;
```

设：

- $$
  s_n = \text{now\_speed}(n)
  $$

  
- $$
  M = \text{MAX\_SPEED}
  $$

  
- $$
  a = \text{accelerate\_sensor}
  $$

  

得到差分方程：

$$
s_{n+1} = s_n + a(M - s_n)
$$


------

## 2️⃣ 代数整理（不做任何近似）

$$
\begin{aligned} 
s_{n+1} &= s_n + aM - a s_n \\ 
&= (1 - a) s_n + aM 
\end{aligned}
$$

这是一个**一阶线性非齐次差分方程**。

------

## 3️⃣ 求稳态解（定常解）


$$
假设当 n \to \infty，时速度收敛到常数 s^*，则：s^* = (1 - a)s^* + aM
$$
移项：

$$
a s^* = aM \quad\Rightarrow\quad s^* = M
$$
👉 **稳态值就是 MAX_SPEED**

------

## 4️⃣ 消元：转化为齐次方程（关键一步）

定义偏差变量：

$$
x_n = s_n - M
$$
代入原方程：

$$
\begin{aligned} 
x_{n+1} &= s_{n+1} - M \\ 
&= (1 - a)s_n + aM - M \\ 
&= (1 - a)(x_n + M) + aM - M \\ 
&= (1 - a)x_n 
\end{aligned}
$$
👉 非齐次项被**严格消掉**，不是“省略”。

------

## 5️⃣ 解齐次递推（逐步递推）

递推关系：

$$
x_{n+1} = (1 - a)x_n
$$
设：

$$
x_0 = s_0 - M
$$
展开：

- $$
  x_1 = (1 - a)x_0
  $$

  
- $$
  x_2 = (1 - a)^2 x_0
  $$

  
- $$
  x_3 = (1 - a)^3 x_0
  $$

  

归纳得：

$$
x_n = (s_0 - M)(1 - a)^n
$$


------

## 6️⃣ 回代得到最终解（完整形式）

$$
\boxed{ s_n = M + (s_0 - M)(1 - a)^n = M - (M - s_0)(1 - a)^n }
$$



------

## 7️⃣ 严格性质验证

### 初值一致

$$
n = 0 \Rightarrow s_0
$$



### 极限

$$
0 < a < 1 \Rightarrow (1 - a)^n \to 0 \Rightarrow s_n \to M
$$



### 不超速

$$
s_n \le M
$$

✔ 数学与工程完全一致

------

# 二、减速曲线：严格推导

## 1️⃣ 从代码出发

```
now_speed += now_speed * diff * slow_sensor;
```

设：

- $$
  k = \text{diff} \cdot \text{slow\_sensor}
  $$

  

则：

$$
s_{n+1} = s_n + k s_n = (1 + k)s_n
$$


------

## 2️⃣ 齐次差分方程（无常数项）

这是最基本的形式：

$$
s_{n+1} = r s_n \quad\text{其中 } r = 1 + k
$$


------

## 3️⃣ 逐步递推（完全展开）

设 $s_0 = c$

- $$
  s_1 = c r
  $$

  
- $$
  s_2 = c r^2
  $$

  
- $$
  s_3 = c r^3
  $$

  

归纳：

$$
\boxed{ s_n = c (1 + k)^n }
$$


------

## 4️⃣ 稳定性条件（严格）

- 若 
  $$
  -1 < k < 0，0 < 1 + k < 1
  \\
  指数衰减，稳定
  $$
  
- 若 
  $$
  k \le -1\\
  震荡或符号翻转（不物理）
  $$
  
- 若 
  $$
  k > 0\\
  指数发散（加速而不是减速）
  $$
  

------

# 三、为什么这两段“本质一样”

| 分支 | 数学本质               |
| ---- | ---------------------- |
| 加速 | 对「目标值」的指数逼近 |
| 减速 | 对「当前值」的指数缩放 |

统一抽象：

$$
s_{n+1} = \alpha s_n + \beta
$$
